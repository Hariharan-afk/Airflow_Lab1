[2025-11-04T02:30:57.574+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-11-04T02:30:57.585+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: 02_monitoring_pipeline.monitor_batch_10 manual__2025-11-04T02:30:49.085012+00:00 [queued]>
[2025-11-04T02:30:57.590+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: 02_monitoring_pipeline.monitor_batch_10 manual__2025-11-04T02:30:49.085012+00:00 [queued]>
[2025-11-04T02:30:57.591+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2025-11-04T02:30:57.598+0000] {taskinstance.py:2889} INFO - Executing <Task(PythonOperator): monitor_batch_10> on 2025-11-04 02:30:49.085012+00:00
[2025-11-04T02:30:57.605+0000] {standard_task_runner.py:72} INFO - Started process 4391 to run task
[2025-11-04T02:30:57.607+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', '02_monitoring_pipeline', 'monitor_batch_10', 'manual__2025-11-04T02:30:49.085012+00:00', '--job-id', '41', '--raw', '--subdir', 'DAGS_FOLDER/02_monitoring_pipeline.py', '--cfg-path', '/tmp/tmpvhtt2z3r']
[2025-11-04T02:30:57.610+0000] {standard_task_runner.py:105} INFO - Job 41: Subtask monitor_batch_10
[2025-11-04T02:30:57.645+0000] {task_command.py:467} INFO - Running <TaskInstance: 02_monitoring_pipeline.monitor_batch_10 manual__2025-11-04T02:30:49.085012+00:00 [running]> on host 1008f8fef9d0
[2025-11-04T02:30:57.696+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops_team' AIRFLOW_CTX_DAG_ID='02_monitoring_pipeline' AIRFLOW_CTX_TASK_ID='monitor_batch_10' AIRFLOW_CTX_EXECUTION_DATE='2025-11-04T02:30:49.085012+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-04T02:30:49.085012+00:00'
[2025-11-04T02:30:57.697+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-11-04T02:30:57.705+0000] {logging_mixin.py:190} INFO - 
================================================================================
[2025-11-04T02:30:57.705+0000] {logging_mixin.py:190} INFO - üîç MONITORING BATCH 10
[2025-11-04T02:30:57.706+0000] {logging_mixin.py:190} INFO - ================================================================================
[2025-11-04T02:30:57.710+0000] {logging_mixin.py:190} INFO - üì• Step 1: Loading Batch 10 data...
[2025-11-04T02:30:57.714+0000] {logging_mixin.py:190} INFO - üìÑ Loading batch 10 from data/raw/batch10.dat
[2025-11-04T02:30:57.949+0000] {logging_mixin.py:190} INFO - ‚úÖ Loaded 3600 samples from batch 10
[2025-11-04T02:30:57.951+0000] {logging_mixin.py:190} INFO -    Class distribution: {1: 600, 2: 600, 3: 600, 4: 600, 5: 600, 6: 600}
[2025-11-04T02:30:57.952+0000] {logging_mixin.py:190} INFO - 
ü§ñ Step 2: Loading trained model and scaler...
[2025-11-04T02:30:57.970+0000] {logging_mixin.py:190} INFO - üìÇ Loaded model from: models/latest_model.pkl
[2025-11-04T02:30:57.972+0000] {logging_mixin.py:190} INFO - üìÇ Loaded metadata from: models/latest_model_metadata.json
[2025-11-04T02:30:57.973+0000] {logging_mixin.py:190} INFO - 
‚öôÔ∏è Step 3: Scaling features...
[2025-11-04T02:30:57.983+0000] {logging_mixin.py:190} INFO - 
üìä Step 4: Loading baseline metrics...
[2025-11-04T02:30:57.985+0000] {logging_mixin.py:190} INFO - 
üìö Step 5: Loading reference (training) data...
[2025-11-04T02:30:58.103+0000] {logging_mixin.py:190} INFO - 
üéØ Step 6: Evaluating model on Batch 10...
[2025-11-04T02:30:58.115+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168 UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
[2025-11-04T02:30:58.127+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168 UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
[2025-11-04T02:30:58.161+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:58.162+0000] {logging_mixin.py:190} INFO - üìä EVALUATION RESULTS - BATCH 10
[2025-11-04T02:30:58.162+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:58.163+0000] {logging_mixin.py:190} INFO - 
üìà Overall Metrics:
[2025-11-04T02:30:58.163+0000] {logging_mixin.py:190} INFO -    Samples:         3600
[2025-11-04T02:30:58.163+0000] {logging_mixin.py:190} INFO -    Accuracy:        0.4292
[2025-11-04T02:30:58.163+0000] {logging_mixin.py:190} INFO -    Precision (macro): 0.4852
[2025-11-04T02:30:58.164+0000] {logging_mixin.py:190} INFO -    Recall (macro):    0.4292
[2025-11-04T02:30:58.164+0000] {logging_mixin.py:190} INFO -    F1-Score (macro):  0.4075
[2025-11-04T02:30:58.164+0000] {logging_mixin.py:190} INFO - 
üéØ Per-Class Performance:
[2025-11-04T02:30:58.165+0000] {logging_mixin.py:190} INFO -    Class Name            Precision  Recall     F1-Score   Support   
[2025-11-04T02:30:58.165+0000] {logging_mixin.py:190} INFO -    ----------------------------------------------------------------------
[2025-11-04T02:30:58.165+0000] {logging_mixin.py:190} INFO -    1     Ethanol         0.3040     0.3917     0.3423     600       
[2025-11-04T02:30:58.165+0000] {logging_mixin.py:190} INFO -    2     Ethylene        0.3519     0.6750     0.4626     600       
[2025-11-04T02:30:58.166+0000] {logging_mixin.py:190} INFO -    3     Ammonia         0.6489     0.2833     0.3944     600       
[2025-11-04T02:30:58.166+0000] {logging_mixin.py:190} INFO -    4     Acetaldehyde    0.2366     0.1033     0.1439     600       
[2025-11-04T02:30:58.166+0000] {logging_mixin.py:190} INFO -    5     Acetone         0.5158     0.7900     0.6241     600       
[2025-11-04T02:30:58.167+0000] {logging_mixin.py:190} INFO -    6     Toluene         0.8541     0.3317     0.4778     600       
[2025-11-04T02:30:58.167+0000] {logging_mixin.py:190} INFO - 
üîÆ Prediction Confidence:
[2025-11-04T02:30:58.167+0000] {logging_mixin.py:190} INFO -    Mean:   0.5089
[2025-11-04T02:30:58.167+0000] {logging_mixin.py:190} INFO -    Median: 0.4807
[2025-11-04T02:30:58.168+0000] {logging_mixin.py:190} INFO -    Std:    0.1732
[2025-11-04T02:30:58.168+0000] {logging_mixin.py:190} INFO -    Range:  [0.2099, 1.0000]
[2025-11-04T02:30:58.168+0000] {logging_mixin.py:190} INFO - 
‚ùå Misclassification Analysis:
[2025-11-04T02:30:58.169+0000] {logging_mixin.py:190} INFO -    Misclassified: 2055 (57.08%)
[2025-11-04T02:30:58.169+0000] {logging_mixin.py:190} INFO -    Low Confidence (<0.6): 2639
[2025-11-04T02:30:58.169+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:58.171+0000] {logging_mixin.py:190} INFO - üíæ Saved evaluation report to: data/drift_reports/batch10_evaluation.json
[2025-11-04T02:30:58.172+0000] {logging_mixin.py:190} INFO - 
üìà Step 7: Comparing performance with baseline...
[2025-11-04T02:30:58.172+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:58.172+0000] {logging_mixin.py:190} INFO - üìä COMPARISON: Training (Baseline) vs Batch 10
[2025-11-04T02:30:58.173+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:58.173+0000] {logging_mixin.py:190} INFO - 
üìà Overall Metric Changes:
[2025-11-04T02:30:58.173+0000] {logging_mixin.py:190} INFO -    Accuracy:             -56.95%
[2025-11-04T02:30:58.173+0000] {logging_mixin.py:190} INFO -    F1-Score (macro):     -59.08%
[2025-11-04T02:30:58.174+0000] {logging_mixin.py:190} INFO -    Confidence (mean):    -0.4724
[2025-11-04T02:30:58.174+0000] {logging_mixin.py:190} INFO -    Misclassif. Rate:     +56.95%
[2025-11-04T02:30:58.177+0000] {logging_mixin.py:190} INFO - 
‚ö†Ô∏è Performance Degradation Alerts:
[2025-11-04T02:30:58.178+0000] {logging_mixin.py:190} INFO -    üî¥ Accuracy dropped by 56.95% (threshold: 5.0%)
[2025-11-04T02:30:58.178+0000] {logging_mixin.py:190} INFO -    üî¥ F1-Score dropped by 59.08% (threshold: 5.0%)
[2025-11-04T02:30:58.178+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:58.178+0000] {logging_mixin.py:190} INFO - 
üî¨ Step 8: Detecting statistical drift...
[2025-11-04T02:30:58.181+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:58.182+0000] {logging_mixin.py:190} INFO - üî¨ COMPREHENSIVE DRIFT ANALYSIS - BATCH 10
[2025-11-04T02:30:58.182+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:58.185+0000] {logging_mixin.py:190} INFO - 
üîç Detecting drift in 20 features...
[2025-11-04T02:30:59.254+0000] {logging_mixin.py:190} INFO - 
üè∑Ô∏è Detecting label distribution drift...
[2025-11-04T02:30:59.257+0000] {logging_mixin.py:190} INFO -    Chi-square p-value: 0.0000
[2025-11-04T02:30:59.258+0000] {logging_mixin.py:190} INFO -    KL Divergence: 0.1291
[2025-11-04T02:30:59.259+0000] {logging_mixin.py:190} INFO -    PSI: 0.2493
[2025-11-04T02:30:59.259+0000] {logging_mixin.py:190} INFO -    Drift detected: Yes
[2025-11-04T02:30:59.260+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:59.260+0000] {logging_mixin.py:190} INFO - üîç STATISTICAL DRIFT DETECTION - BATCH 10
[2025-11-04T02:30:59.261+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:59.261+0000] {logging_mixin.py:190} INFO - 
üìä Drift Detection Summary:
[2025-11-04T02:30:59.261+0000] {logging_mixin.py:190} INFO -    Features Tested: 20
[2025-11-04T02:30:59.262+0000] {logging_mixin.py:190} INFO -    Total Features with Drift: 20
[2025-11-04T02:30:59.262+0000] {logging_mixin.py:190} INFO -    - PSI Drift:          20
[2025-11-04T02:30:59.262+0000] {logging_mixin.py:190} INFO -    - KS Test Drift:      20
[2025-11-04T02:30:59.263+0000] {logging_mixin.py:190} INFO -    - Wasserstein Drift:  0
[2025-11-04T02:30:59.263+0000] {logging_mixin.py:190} INFO - 
‚ö†Ô∏è DRIFT DETECTED!
[2025-11-04T02:30:59.263+0000] {logging_mixin.py:190} INFO - 
   Top Drifted Features (by PSI):
[2025-11-04T02:30:59.264+0000] {logging_mixin.py:190} INFO -        1. feature_72: PSI=3.5559, KS_p=0.0000, Wass=0.1793
[2025-11-04T02:30:59.264+0000] {logging_mixin.py:190} INFO -        2. feature_109: PSI=2.9767, KS_p=0.0000, Wass=0.0106
[2025-11-04T02:30:59.264+0000] {logging_mixin.py:190} INFO -        3. feature_108: PSI=2.8240, KS_p=0.0000, Wass=0.0809
[2025-11-04T02:30:59.265+0000] {logging_mixin.py:190} INFO -        4. feature_101: PSI=2.8238, KS_p=0.0000, Wass=0.0105
[2025-11-04T02:30:59.265+0000] {logging_mixin.py:190} INFO -        5. feature_80: PSI=1.9118, KS_p=0.0000, Wass=0.1442
[2025-11-04T02:30:59.265+0000] {logging_mixin.py:190} INFO -        6. feature_16: PSI=1.8650, KS_p=0.0000, Wass=0.1521
[2025-11-04T02:30:59.265+0000] {logging_mixin.py:190} INFO -        7. feature_69: PSI=1.6048, KS_p=0.0000, Wass=0.0721
[2025-11-04T02:30:59.265+0000] {logging_mixin.py:190} INFO -        8. feature_8: PSI=0.9821, KS_p=0.0000, Wass=0.0670
[2025-11-04T02:30:59.266+0000] {logging_mixin.py:190} INFO -        9. feature_12: PSI=0.7473, KS_p=0.0000, Wass=0.0557
[2025-11-04T02:30:59.266+0000] {logging_mixin.py:190} INFO -       10. feature_100: PSI=0.7400, KS_p=0.0000, Wass=0.0715
[2025-11-04T02:30:59.266+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:59.271+0000] {logging_mixin.py:190} INFO - üíæ Saved drift report to: data/drift_reports/drift_report_batch10_20251104_023059.json
[2025-11-04T02:30:59.272+0000] {logging_mixin.py:190} INFO - 
üìâ Step 9: Monitoring performance degradation...
[2025-11-04T02:30:59.272+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:59.272+0000] {logging_mixin.py:190} INFO - üìä COMPREHENSIVE PERFORMANCE MONITORING - BATCH 10
[2025-11-04T02:30:59.272+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:59.275+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:59.276+0000] {logging_mixin.py:190} INFO - üìâ PERFORMANCE DEGRADATION MONITORING - BATCH 10
[2025-11-04T02:30:59.276+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:59.276+0000] {logging_mixin.py:190} INFO - 
üìä Performance Changes:
[2025-11-04T02:30:59.276+0000] {logging_mixin.py:190} INFO -    Accuracy:       0.9987 ‚Üí 0.4292 (-0.5695)
[2025-11-04T02:30:59.277+0000] {logging_mixin.py:190} INFO -    F1-Score:       0.9983 ‚Üí 0.4075 (-0.5908)
[2025-11-04T02:30:59.277+0000] {logging_mixin.py:190} INFO -    Precision:      0.9991 ‚Üí 0.4852 (-0.5139)
[2025-11-04T02:30:59.277+0000] {logging_mixin.py:190} INFO -    Recall:         0.9975 ‚Üí 0.4292 (-0.5684)
[2025-11-04T02:30:59.277+0000] {logging_mixin.py:190} INFO -    Confidence:     0.9814 ‚Üí 0.5089 (-0.4724)
[2025-11-04T02:30:59.278+0000] {logging_mixin.py:190} INFO - 
‚ö†Ô∏è Degradation Analysis:
[2025-11-04T02:30:59.278+0000] {logging_mixin.py:190} INFO -    üî¥ PERFORMANCE DEGRADATION DETECTED!
[2025-11-04T02:30:59.278+0000] {logging_mixin.py:190} INFO -       - Accuracy change (56.95%) exceeds threshold (5.0%)
[2025-11-04T02:30:59.278+0000] {logging_mixin.py:190} INFO -       - F1-Score change (59.08%) exceeds threshold (5.0%)
[2025-11-04T02:30:59.278+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:59.279+0000] {logging_mixin.py:190} INFO - 
üîÆ Analyzing Prediction Confidence Drift - Batch 10
[2025-11-04T02:30:59.281+0000] {logging_mixin.py:190} INFO -    Mean Confidence: 0.9814 ‚Üí 0.5089 (-0.4724)
[2025-11-04T02:30:59.281+0000] {logging_mixin.py:190} INFO -    Std Confidence:  0.0569 ‚Üí 0.1732 (+0.1163)
[2025-11-04T02:30:59.282+0000] {logging_mixin.py:190} INFO -    ‚ö†Ô∏è WARNING: Mean confidence (0.5089) below threshold (0.6)
[2025-11-04T02:30:59.284+0000] {logging_mixin.py:190} INFO - 
üéØ Analyzing Misclassification Patterns - Batch 10
[2025-11-04T02:30:59.285+0000] {logging_mixin.py:190} INFO -    Found 15 significant changes in misclassification patterns:
[2025-11-04T02:30:59.285+0000] {logging_mixin.py:190} INFO -       1. Ammonia ‚Üí Ethylene: +0.680
[2025-11-04T02:30:59.285+0000] {logging_mixin.py:190} INFO -       2. Acetaldehyde ‚Üí Ethanol: +0.505
[2025-11-04T02:30:59.285+0000] {logging_mixin.py:190} INFO -       3. Ethanol ‚Üí Acetone: +0.368
[2025-11-04T02:30:59.286+0000] {logging_mixin.py:190} INFO -       4. Toluene ‚Üí Ethanol: +0.268
[2025-11-04T02:30:59.286+0000] {logging_mixin.py:190} INFO -       5. Toluene ‚Üí Acetaldehyde: +0.183
[2025-11-04T02:30:59.286+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:59.286+0000] {logging_mixin.py:190} INFO - üéØ OVERALL ASSESSMENT:
[2025-11-04T02:30:59.287+0000] {logging_mixin.py:190} INFO -    üî¥ CONCEPT DRIFT DETECTED - Model performance degraded!
[2025-11-04T02:30:59.287+0000] {logging_mixin.py:190} INFO -    üìå Recommendation: Consider retraining the model
[2025-11-04T02:30:59.287+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:59.293+0000] {logging_mixin.py:190} INFO - üíæ Saved performance report to: data/drift_reports/performance_report_batch10_20251104_023059.json
[2025-11-04T02:30:59.293+0000] {logging_mixin.py:190} INFO - 
================================================================================
[2025-11-04T02:30:59.293+0000] {logging_mixin.py:190} INFO - üéØ OVERALL DRIFT ASSESSMENT - BATCH 10
[2025-11-04T02:30:59.294+0000] {logging_mixin.py:190} INFO - ================================================================================
[2025-11-04T02:30:59.294+0000] {logging_mixin.py:190} INFO - 
üìä Drift Detection Summary:
[2025-11-04T02:30:59.294+0000] {logging_mixin.py:190} INFO -    Statistical Drift (Feature Distribution): üî¥ DETECTED
[2025-11-04T02:30:59.294+0000] {logging_mixin.py:190} INFO -    Performance Drift (Model Degradation):   üî¥ DETECTED
[2025-11-04T02:30:59.295+0000] {logging_mixin.py:190} INFO - 
‚ö†Ô∏è DRIFT DETECTED IN BATCH 10!
[2025-11-04T02:30:59.295+0000] {logging_mixin.py:190} INFO - 
   üìå Recommendations:
[2025-11-04T02:30:59.296+0000] {logging_mixin.py:190} INFO -       - Feature distributions have shifted significantly
[2025-11-04T02:30:59.296+0000] {logging_mixin.py:190} INFO -       - Input data characteristics are changing
[2025-11-04T02:30:59.296+0000] {logging_mixin.py:190} INFO -       - Model performance has degraded
[2025-11-04T02:30:59.297+0000] {logging_mixin.py:190} INFO -       - Relationship between features and labels may have changed
[2025-11-04T02:30:59.297+0000] {logging_mixin.py:190} INFO -       - Consider retraining the model with recent data
[2025-11-04T02:30:59.297+0000] {logging_mixin.py:190} INFO -       - Review data collection process for anomalies
[2025-11-04T02:30:59.297+0000] {logging_mixin.py:190} INFO - 
================================================================================
[2025-11-04T02:30:59.333+0000] {python.py:240} INFO - Done. Returned value was: {'batch_id': 10, 'accuracy': 0.42916666666666664, 'f1_macro': 0.40751297975889544, 'statistical_drift': True, 'performance_drift': True, 'drift_detected': True}
[2025-11-04T02:30:59.344+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-11-04T02:30:59.345+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=02_monitoring_pipeline, task_id=monitor_batch_10, run_id=manual__2025-11-04T02:30:49.085012+00:00, execution_date=20251104T023049, start_date=20251104T023057, end_date=20251104T023059
[2025-11-04T02:30:59.387+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-11-04T02:30:59.393+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
