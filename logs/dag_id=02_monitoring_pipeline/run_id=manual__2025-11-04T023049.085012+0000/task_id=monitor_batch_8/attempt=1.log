[2025-11-04T02:30:53.540+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-11-04T02:30:53.551+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: 02_monitoring_pipeline.monitor_batch_8 manual__2025-11-04T02:30:49.085012+00:00 [queued]>
[2025-11-04T02:30:53.556+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: 02_monitoring_pipeline.monitor_batch_8 manual__2025-11-04T02:30:49.085012+00:00 [queued]>
[2025-11-04T02:30:53.556+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2025-11-04T02:30:53.563+0000] {taskinstance.py:2889} INFO - Executing <Task(PythonOperator): monitor_batch_8> on 2025-11-04 02:30:49.085012+00:00
[2025-11-04T02:30:53.569+0000] {standard_task_runner.py:72} INFO - Started process 4337 to run task
[2025-11-04T02:30:53.572+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', '02_monitoring_pipeline', 'monitor_batch_8', 'manual__2025-11-04T02:30:49.085012+00:00', '--job-id', '39', '--raw', '--subdir', 'DAGS_FOLDER/02_monitoring_pipeline.py', '--cfg-path', '/tmp/tmpr82ejjek']
[2025-11-04T02:30:53.574+0000] {standard_task_runner.py:105} INFO - Job 39: Subtask monitor_batch_8
[2025-11-04T02:30:53.606+0000] {task_command.py:467} INFO - Running <TaskInstance: 02_monitoring_pipeline.monitor_batch_8 manual__2025-11-04T02:30:49.085012+00:00 [running]> on host 1008f8fef9d0
[2025-11-04T02:30:53.652+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops_team' AIRFLOW_CTX_DAG_ID='02_monitoring_pipeline' AIRFLOW_CTX_TASK_ID='monitor_batch_8' AIRFLOW_CTX_EXECUTION_DATE='2025-11-04T02:30:49.085012+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-04T02:30:49.085012+00:00'
[2025-11-04T02:30:53.654+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-11-04T02:30:53.661+0000] {logging_mixin.py:190} INFO - 
================================================================================
[2025-11-04T02:30:53.662+0000] {logging_mixin.py:190} INFO - üîç MONITORING BATCH 8
[2025-11-04T02:30:53.662+0000] {logging_mixin.py:190} INFO - ================================================================================
[2025-11-04T02:30:53.666+0000] {logging_mixin.py:190} INFO - üì• Step 1: Loading Batch 8 data...
[2025-11-04T02:30:53.670+0000] {logging_mixin.py:190} INFO - üìÑ Loading batch 8 from data/raw/batch8.dat
[2025-11-04T02:30:53.695+0000] {logging_mixin.py:190} INFO - ‚úÖ Loaded 294 samples from batch 8
[2025-11-04T02:30:53.697+0000] {logging_mixin.py:190} INFO -    Class distribution: {1: 30, 2: 30, 3: 40, 4: 33, 5: 143, 6: 18}
[2025-11-04T02:30:53.697+0000] {logging_mixin.py:190} INFO - 
ü§ñ Step 2: Loading trained model and scaler...
[2025-11-04T02:30:53.717+0000] {logging_mixin.py:190} INFO - üìÇ Loaded model from: models/latest_model.pkl
[2025-11-04T02:30:53.718+0000] {logging_mixin.py:190} INFO - üìÇ Loaded metadata from: models/latest_model_metadata.json
[2025-11-04T02:30:53.720+0000] {logging_mixin.py:190} INFO - 
‚öôÔ∏è Step 3: Scaling features...
[2025-11-04T02:30:53.729+0000] {logging_mixin.py:190} INFO - 
üìä Step 4: Loading baseline metrics...
[2025-11-04T02:30:53.733+0000] {logging_mixin.py:190} INFO - 
üìö Step 5: Loading reference (training) data...
[2025-11-04T02:30:53.864+0000] {logging_mixin.py:190} INFO - 
üéØ Step 6: Evaluating model on Batch 8...
[2025-11-04T02:30:53.872+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168 UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
[2025-11-04T02:30:53.876+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168 UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
[2025-11-04T02:30:53.899+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:53.899+0000] {logging_mixin.py:190} INFO - üìä EVALUATION RESULTS - BATCH 8
[2025-11-04T02:30:53.899+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:53.900+0000] {logging_mixin.py:190} INFO - 
üìà Overall Metrics:
[2025-11-04T02:30:53.900+0000] {logging_mixin.py:190} INFO -    Samples:         294
[2025-11-04T02:30:53.900+0000] {logging_mixin.py:190} INFO -    Accuracy:        0.8061
[2025-11-04T02:30:53.901+0000] {logging_mixin.py:190} INFO -    Precision (macro): 0.7333
[2025-11-04T02:30:53.901+0000] {logging_mixin.py:190} INFO -    Recall (macro):    0.6558
[2025-11-04T02:30:53.901+0000] {logging_mixin.py:190} INFO -    F1-Score (macro):  0.6296
[2025-11-04T02:30:53.901+0000] {logging_mixin.py:190} INFO - 
üéØ Per-Class Performance:
[2025-11-04T02:30:53.901+0000] {logging_mixin.py:190} INFO -    Class Name            Precision  Recall     F1-Score   Support   
[2025-11-04T02:30:53.902+0000] {logging_mixin.py:190} INFO -    ----------------------------------------------------------------------
[2025-11-04T02:30:53.902+0000] {logging_mixin.py:190} INFO -    1     Ethanol         0.7500     1.0000     0.8571     30        
[2025-11-04T02:30:53.902+0000] {logging_mixin.py:190} INFO -    2     Ethylene        1.0000     0.9667     0.9831     30        
[2025-11-04T02:30:53.902+0000] {logging_mixin.py:190} INFO -    3     Ammonia         0.5741     0.7750     0.6596     40        
[2025-11-04T02:30:53.902+0000] {logging_mixin.py:190} INFO -    4     Acetaldehyde    1.0000     0.1515     0.2632     33        
[2025-11-04T02:30:53.903+0000] {logging_mixin.py:190} INFO -    5     Acetone         0.8758     0.9860     0.9276     143       
[2025-11-04T02:30:53.903+0000] {logging_mixin.py:190} INFO -    6     Toluene         0.2000     0.0556     0.0870     18        
[2025-11-04T02:30:53.904+0000] {logging_mixin.py:190} INFO - 
üîÆ Prediction Confidence:
[2025-11-04T02:30:53.904+0000] {logging_mixin.py:190} INFO -    Mean:   0.4634
[2025-11-04T02:30:53.904+0000] {logging_mixin.py:190} INFO -    Median: 0.4225
[2025-11-04T02:30:53.905+0000] {logging_mixin.py:190} INFO -    Std:    0.1386
[2025-11-04T02:30:53.905+0000] {logging_mixin.py:190} INFO -    Range:  [0.2249, 0.8118]
[2025-11-04T02:30:53.905+0000] {logging_mixin.py:190} INFO - 
‚ùå Misclassification Analysis:
[2025-11-04T02:30:53.906+0000] {logging_mixin.py:190} INFO -    Misclassified: 57 (19.39%)
[2025-11-04T02:30:53.906+0000] {logging_mixin.py:190} INFO -    Low Confidence (<0.6): 248
[2025-11-04T02:30:53.906+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:53.908+0000] {logging_mixin.py:190} INFO - üíæ Saved evaluation report to: data/drift_reports/batch8_evaluation.json
[2025-11-04T02:30:53.909+0000] {logging_mixin.py:190} INFO - 
üìà Step 7: Comparing performance with baseline...
[2025-11-04T02:30:53.909+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:53.909+0000] {logging_mixin.py:190} INFO - üìä COMPARISON: Training (Baseline) vs Batch 8
[2025-11-04T02:30:53.910+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:53.910+0000] {logging_mixin.py:190} INFO - 
üìà Overall Metric Changes:
[2025-11-04T02:30:53.910+0000] {logging_mixin.py:190} INFO -    Accuracy:             -19.25%
[2025-11-04T02:30:53.910+0000] {logging_mixin.py:190} INFO -    F1-Score (macro):     -36.87%
[2025-11-04T02:30:53.910+0000] {logging_mixin.py:190} INFO -    Confidence (mean):    -0.5180
[2025-11-04T02:30:53.911+0000] {logging_mixin.py:190} INFO -    Misclassif. Rate:     +19.25%
[2025-11-04T02:30:53.913+0000] {logging_mixin.py:190} INFO - 
‚ö†Ô∏è Performance Degradation Alerts:
[2025-11-04T02:30:53.913+0000] {logging_mixin.py:190} INFO -    üî¥ Accuracy dropped by 19.25% (threshold: 5.0%)
[2025-11-04T02:30:53.914+0000] {logging_mixin.py:190} INFO -    üî¥ F1-Score dropped by 36.87% (threshold: 5.0%)
[2025-11-04T02:30:53.914+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:53.914+0000] {logging_mixin.py:190} INFO - 
üî¨ Step 8: Detecting statistical drift...
[2025-11-04T02:30:53.917+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:53.917+0000] {logging_mixin.py:190} INFO - üî¨ COMPREHENSIVE DRIFT ANALYSIS - BATCH 8
[2025-11-04T02:30:53.917+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:53.920+0000] {logging_mixin.py:190} INFO - 
üîç Detecting drift in 20 features...
[2025-11-04T02:30:54.017+0000] {logging_mixin.py:190} INFO - 
üè∑Ô∏è Detecting label distribution drift...
[2025-11-04T02:30:54.020+0000] {logging_mixin.py:190} INFO -    Chi-square p-value: 0.0000
[2025-11-04T02:30:54.020+0000] {logging_mixin.py:190} INFO -    KL Divergence: 0.1954
[2025-11-04T02:30:54.021+0000] {logging_mixin.py:190} INFO -    PSI: 0.4092
[2025-11-04T02:30:54.021+0000] {logging_mixin.py:190} INFO -    Drift detected: Yes
[2025-11-04T02:30:54.021+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:54.021+0000] {logging_mixin.py:190} INFO - üîç STATISTICAL DRIFT DETECTION - BATCH 8
[2025-11-04T02:30:54.022+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:54.022+0000] {logging_mixin.py:190} INFO - 
üìä Drift Detection Summary:
[2025-11-04T02:30:54.022+0000] {logging_mixin.py:190} INFO -    Features Tested: 20
[2025-11-04T02:30:54.022+0000] {logging_mixin.py:190} INFO -    Total Features with Drift: 20
[2025-11-04T02:30:54.023+0000] {logging_mixin.py:190} INFO -    - PSI Drift:          20
[2025-11-04T02:30:54.023+0000] {logging_mixin.py:190} INFO -    - KS Test Drift:      20
[2025-11-04T02:30:54.024+0000] {logging_mixin.py:190} INFO -    - Wasserstein Drift:  0
[2025-11-04T02:30:54.024+0000] {logging_mixin.py:190} INFO - 
‚ö†Ô∏è DRIFT DETECTED!
[2025-11-04T02:30:54.024+0000] {logging_mixin.py:190} INFO - 
   Top Drifted Features (by PSI):
[2025-11-04T02:30:54.025+0000] {logging_mixin.py:190} INFO -        1. feature_6: PSI=16.4292, KS_p=0.0000, Wass=0.2140
[2025-11-04T02:30:54.025+0000] {logging_mixin.py:190} INFO -        2. feature_8: PSI=13.3758, KS_p=0.0000, Wass=0.1281
[2025-11-04T02:30:54.026+0000] {logging_mixin.py:190} INFO -        3. feature_2: PSI=8.0695, KS_p=0.0000, Wass=0.0088
[2025-11-04T02:30:54.026+0000] {logging_mixin.py:190} INFO -        4. feature_44: PSI=7.5159, KS_p=0.0000, Wass=0.0268
[2025-11-04T02:30:54.027+0000] {logging_mixin.py:190} INFO -        5. feature_69: PSI=7.2915, KS_p=0.0000, Wass=0.0853
[2025-11-04T02:30:54.027+0000] {logging_mixin.py:190} INFO -        6. feature_124: PSI=5.8186, KS_p=0.0000, Wass=0.0736
[2025-11-04T02:30:54.027+0000] {logging_mixin.py:190} INFO -        7. feature_80: PSI=5.5324, KS_p=0.0000, Wass=0.0729
[2025-11-04T02:30:54.028+0000] {logging_mixin.py:190} INFO -        8. feature_101: PSI=5.4906, KS_p=0.0000, Wass=0.0173
[2025-11-04T02:30:54.028+0000] {logging_mixin.py:190} INFO -        9. feature_72: PSI=5.2099, KS_p=0.0000, Wass=0.0601
[2025-11-04T02:30:54.028+0000] {logging_mixin.py:190} INFO -       10. feature_14: PSI=4.9353, KS_p=0.0000, Wass=0.1479
[2025-11-04T02:30:54.028+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:54.033+0000] {logging_mixin.py:190} INFO - üíæ Saved drift report to: data/drift_reports/drift_report_batch8_20251104_023054.json
[2025-11-04T02:30:54.033+0000] {logging_mixin.py:190} INFO - 
üìâ Step 9: Monitoring performance degradation...
[2025-11-04T02:30:54.033+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:54.034+0000] {logging_mixin.py:190} INFO - üìä COMPREHENSIVE PERFORMANCE MONITORING - BATCH 8
[2025-11-04T02:30:54.034+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:54.036+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:54.037+0000] {logging_mixin.py:190} INFO - üìâ PERFORMANCE DEGRADATION MONITORING - BATCH 8
[2025-11-04T02:30:54.037+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:54.037+0000] {logging_mixin.py:190} INFO - 
üìä Performance Changes:
[2025-11-04T02:30:54.037+0000] {logging_mixin.py:190} INFO -    Accuracy:       0.9987 ‚Üí 0.8061 (-0.1925)
[2025-11-04T02:30:54.037+0000] {logging_mixin.py:190} INFO -    F1-Score:       0.9983 ‚Üí 0.6296 (-0.3687)
[2025-11-04T02:30:54.038+0000] {logging_mixin.py:190} INFO -    Precision:      0.9991 ‚Üí 0.7333 (-0.2658)
[2025-11-04T02:30:54.038+0000] {logging_mixin.py:190} INFO -    Recall:         0.9975 ‚Üí 0.6558 (-0.3417)
[2025-11-04T02:30:54.038+0000] {logging_mixin.py:190} INFO -    Confidence:     0.9814 ‚Üí 0.4634 (-0.5180)
[2025-11-04T02:30:54.038+0000] {logging_mixin.py:190} INFO - 
‚ö†Ô∏è Degradation Analysis:
[2025-11-04T02:30:54.039+0000] {logging_mixin.py:190} INFO -    üî¥ PERFORMANCE DEGRADATION DETECTED!
[2025-11-04T02:30:54.039+0000] {logging_mixin.py:190} INFO -       - Accuracy change (19.25%) exceeds threshold (5.0%)
[2025-11-04T02:30:54.039+0000] {logging_mixin.py:190} INFO -       - F1-Score change (36.87%) exceeds threshold (5.0%)
[2025-11-04T02:30:54.039+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:54.039+0000] {logging_mixin.py:190} INFO - 
üîÆ Analyzing Prediction Confidence Drift - Batch 8
[2025-11-04T02:30:54.042+0000] {logging_mixin.py:190} INFO -    Mean Confidence: 0.9814 ‚Üí 0.4634 (-0.5180)
[2025-11-04T02:30:54.043+0000] {logging_mixin.py:190} INFO -    Std Confidence:  0.0569 ‚Üí 0.1386 (+0.0817)
[2025-11-04T02:30:54.043+0000] {logging_mixin.py:190} INFO -    ‚ö†Ô∏è WARNING: Mean confidence (0.4634) below threshold (0.6)
[2025-11-04T02:30:54.046+0000] {logging_mixin.py:190} INFO - 
üéØ Analyzing Misclassification Patterns - Batch 8
[2025-11-04T02:30:54.046+0000] {logging_mixin.py:190} INFO -    Found 6 significant changes in misclassification patterns:
[2025-11-04T02:30:54.046+0000] {logging_mixin.py:190} INFO -       1. Acetaldehyde ‚Üí Ammonia: +0.636
[2025-11-04T02:30:54.047+0000] {logging_mixin.py:190} INFO -       2. Toluene ‚Üí Ethanol: +0.498
[2025-11-04T02:30:54.047+0000] {logging_mixin.py:190} INFO -       3. Toluene ‚Üí Acetone: +0.444
[2025-11-04T02:30:54.047+0000] {logging_mixin.py:190} INFO -       4. Ammonia ‚Üí Acetone: +0.187
[2025-11-04T02:30:54.048+0000] {logging_mixin.py:190} INFO -       5. Acetaldehyde ‚Üí Acetone: +0.121
[2025-11-04T02:30:54.048+0000] {logging_mixin.py:190} INFO - 
============================================================
[2025-11-04T02:30:54.048+0000] {logging_mixin.py:190} INFO - üéØ OVERALL ASSESSMENT:
[2025-11-04T02:30:54.048+0000] {logging_mixin.py:190} INFO -    üî¥ CONCEPT DRIFT DETECTED - Model performance degraded!
[2025-11-04T02:30:54.049+0000] {logging_mixin.py:190} INFO -    üìå Recommendation: Consider retraining the model
[2025-11-04T02:30:54.049+0000] {logging_mixin.py:190} INFO - ============================================================
[2025-11-04T02:30:54.053+0000] {logging_mixin.py:190} INFO - üíæ Saved performance report to: data/drift_reports/performance_report_batch8_20251104_023054.json
[2025-11-04T02:30:54.054+0000] {logging_mixin.py:190} INFO - 
================================================================================
[2025-11-04T02:30:54.054+0000] {logging_mixin.py:190} INFO - üéØ OVERALL DRIFT ASSESSMENT - BATCH 8
[2025-11-04T02:30:54.054+0000] {logging_mixin.py:190} INFO - ================================================================================
[2025-11-04T02:30:54.054+0000] {logging_mixin.py:190} INFO - 
üìä Drift Detection Summary:
[2025-11-04T02:30:54.054+0000] {logging_mixin.py:190} INFO -    Statistical Drift (Feature Distribution): üî¥ DETECTED
[2025-11-04T02:30:54.055+0000] {logging_mixin.py:190} INFO -    Performance Drift (Model Degradation):   üî¥ DETECTED
[2025-11-04T02:30:54.055+0000] {logging_mixin.py:190} INFO - 
‚ö†Ô∏è DRIFT DETECTED IN BATCH 8!
[2025-11-04T02:30:54.055+0000] {logging_mixin.py:190} INFO - 
   üìå Recommendations:
[2025-11-04T02:30:54.055+0000] {logging_mixin.py:190} INFO -       - Feature distributions have shifted significantly
[2025-11-04T02:30:54.056+0000] {logging_mixin.py:190} INFO -       - Input data characteristics are changing
[2025-11-04T02:30:54.056+0000] {logging_mixin.py:190} INFO -       - Model performance has degraded
[2025-11-04T02:30:54.056+0000] {logging_mixin.py:190} INFO -       - Relationship between features and labels may have changed
[2025-11-04T02:30:54.056+0000] {logging_mixin.py:190} INFO -       - Consider retraining the model with recent data
[2025-11-04T02:30:54.056+0000] {logging_mixin.py:190} INFO -       - Review data collection process for anomalies
[2025-11-04T02:30:54.057+0000] {logging_mixin.py:190} INFO - 
================================================================================
[2025-11-04T02:30:54.086+0000] {python.py:240} INFO - Done. Returned value was: {'batch_id': 8, 'accuracy': 0.8061224489795918, 'f1_macro': 0.629585694684822, 'statistical_drift': True, 'performance_drift': True, 'drift_detected': True}
[2025-11-04T02:30:54.096+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-11-04T02:30:54.097+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=02_monitoring_pipeline, task_id=monitor_batch_8, run_id=manual__2025-11-04T02:30:49.085012+00:00, execution_date=20251104T023049, start_date=20251104T023053, end_date=20251104T023054
[2025-11-04T02:30:54.147+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-11-04T02:30:54.160+0000] {taskinstance.py:3895} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-11-04T02:30:54.161+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
